/**
 * Draggable Background plugin for jQuery
 *
 * v1.1.1
 *
 * Copyright (c) 2012 Kenneth Chung
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 */
 !function(e){var t=e(window);var n=function(e,t,n,r){if(arguments.length===3||r){if(n<e){return e}else if(n>t){return t}}return n};var r=function(e){e.clientX=e.originalEvent.touches[0].clientX;e.clientY=e.originalEvent.touches[0].clientY};e.fn.backgroundDraggable=function(i){i=e.extend({},e.fn.backgroundDraggable.defaults,i);return this.each(function(){var s=e(this),o=s.css("background-image"),u=o.match(/^url\(['"]?(.*?)['"]?\)$/i);if(!o||!u){return}var a={width:0,height:0};if(i.bound){var f=new Image;f.onload=function(){a.width=f.width;a.height=f.height};f.src=u[1]}t=s.closest("body");s.css("cursor","move").on("mousedown.dbg touchstart.dbg",function(e){e.preventDefault();if(e.originalEvent.touches){r(e)}else if(e.which!==1){return}var o=e.clientX,u=e.clientY,f=s.css("background-position").match(/(-?\d+).*?\s(-?\d+)/)||[],l=parseInt(f[1],10)||0,c=parseInt(f[2],10)||0;if(typeof i.beforeDrag==="function"){i.beforeDrag(s)}t.on("mousemove.dbg touchmove.dbg",function(e){e.preventDefault();if(e.originalEvent.touches){r(e)}var t=e.clientX,f=e.clientY;l=i.axis==="y"?l:n(s.innerWidth()-a.width,0,l+t-o,i.bound);c=i.axis==="x"?c:n(s.innerHeight()-a.height,0,c+f-u,i.bound);o=t;u=f;s.css("background-position",l+"px "+c+"px");if(typeof i.onDrag==="function"){i.onDrag(s)}});t.on("mouseup.dbg touchend.dbg",function(){t.off("mousemove.dbg touchmove.dbg");if(typeof i.finishDrag==="function"){i.finishDrag(s)}})})})};e.fn.backgroundDraggable.defaults={bound:true,axis:undefined,beforeDrag:undefined,onDrag:undefined,finishDrag:undefined}}(jQuery);
